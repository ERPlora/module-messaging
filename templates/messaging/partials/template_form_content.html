{% load djicons i18n %}

<div class="p-4">
    <!-- Header with back button -->
    <div class="flex items-center gap-4 mb-6">
        <button class="btn btn-ghost btn-sm"
                hx-get="{% url 'messaging:templates' %}"
                hx-target="#main-content-area"
                hx-push-url="true">
            {% icon "arrow-back-outline" %}
        </button>
        <div class="flex-1">
            <h1 class="text-2xl font-bold">
                {% if is_edit %}{% trans "Edit Template" %}{% else %}{% trans "New Template" %}{% endif %}
            </h1>
        </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <div class="lg:col-span-2">
            <div class="card">
                <form hx-post="{% if is_edit %}{% url 'messaging:template_edit' template.pk %}{% else %}{% url 'messaging:template_create' %}{% endif %}"
                      hx-target="#main-content-area"
                      hx-swap="innerHTML">
                    {% csrf_token %}
                    <div class="card-body">
                        <div class="form-group mb-4">
                            <label class="form-group-label">{% trans "Template Name" %}</label>
                            {{ form.name }}
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                            <div class="form-group">
                                <label class="form-group-label">{% trans "Channel" %}</label>
                                {{ form.channel }}
                            </div>
                            <div class="form-group">
                                <label class="form-group-label">{% trans "Category" %}</label>
                                {{ form.category }}
                            </div>
                        </div>

                        <div class="form-group mb-4">
                            <label class="form-group-label">{% trans "Subject (for email)" %}</label>
                            {{ form.subject }}
                        </div>

                        <div class="form-group mb-4">
                            <label class="form-group-label">{% trans "Message Body" %}</label>
                            {{ form.body }}
                        </div>

                        <div class="form-group">
                            <label class="flex items-center gap-3">
                                {{ form.is_active }}
                                <span>{% trans "Active" %}</span>
                            </label>
                        </div>
                    </div>
                    <div class="card-body border-t border-base-200 flex justify-end gap-2">
                        <button type="button" class="btn btn-ghost"
                                hx-get="{% url 'messaging:templates' %}"
                                hx-target="#main-content-area"
                                hx-push-url="true">
                            {% trans "Cancel" %}
                        </button>
                        <button type="submit" class="btn color-primary">
                            {% icon "save-outline" %}
                            {% if is_edit %}{% trans "Save Changes" %}{% else %}{% trans "Create Template" %}{% endif %}
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Help -->
        <div class="lg:col-span-1">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">{% icon "help-circle-outline" css_class="text-primary" %} {% trans "Template Variables" %}</h3>
                </div>
                <div class="card-body">
                    <p class="text-sm text-base-content/60 mb-3">{% trans "Available variables for use in your template:" %}</p>
                    <div class="space-y-2">
                        <code class="text-xs bg-base-200 px-2 py-1 rounded block">{{ '{{customer_name}}' }}</code>
                        <code class="text-xs bg-base-200 px-2 py-1 rounded block">{{ '{{business_name}}' }}</code>
                        <code class="text-xs bg-base-200 px-2 py-1 rounded block">{{ '{{appointment_date}}' }}</code>
                        <code class="text-xs bg-base-200 px-2 py-1 rounded block">{{ '{{appointment_time}}' }}</code>
                        <code class="text-xs bg-base-200 px-2 py-1 rounded block">{{ '{{service_name}}' }}</code>
                        <code class="text-xs bg-base-200 px-2 py-1 rounded block">{{ '{{staff_name}}' }}</code>
                        <code class="text-xs bg-base-200 px-2 py-1 rounded block">{{ '{{total_amount}}' }}</code>
                        <code class="text-xs bg-base-200 px-2 py-1 rounded block">{{ '{{receipt_url}}' }}</code>
                    </div>
                </div>
            </div>

            <div class="callout callout-info mt-4">
                <div class="callout-icon">{% icon "information-circle-outline" %}</div>
                <div class="callout-content">
                    <div class="callout-title">{% trans "Tip" %}</div>
                    <div class="callout-text">{% trans "Templates marked as 'All Channels' can be used for WhatsApp, SMS, and email. For email, remember to set a subject line." %}</div>
                </div>
            </div>
        </div>
    </div>
</div>
